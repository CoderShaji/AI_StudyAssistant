# AI Study Assistant

Short description
-----------------

AI Study Assistant is a cross-platform Flutter application that helps students create, review, and manage concise flashcards generated by an AI (Gemini). Users provide text, files, or links; the app composes a strict generator prompt, sends it to Gemini, parses compact Question/Answer pairs, and stores results per-user and per-subject in Firestore. A subject-scoped chat interface (with priming) supports contextual follow-ups and a generator history lets users reopen past prompt→answer sessions.

## Features
- Generate flashcards from text, files, images, or links using Gemini.
- Subject-scoped chat with priming to keep answers on-topic.
- Persisted flashcard sets (History) with full sent `prompt` and user `userPrompt`.
- Paired generator history (prompt → answer) for quick reopening.
- Flashcard review UI with flip cards and large navigation controls.
- Delete and manage saved sets and chat entries.
- Cross-platform: Android, iOS, web, and desktop via Flutter.

## Tech Stack
- Language / Framework: Dart / Flutter
- AI: Gemini (via `lib/services/gemini_service.dart`)
- Database: Firebase Firestore (per-user collections)
- State management: Provider (`lib/state/subject_provider.dart`)
- Key packages: flutter_dotenv, firebase_core, firebase_auth, cloud_firestore, image_picker, file_picker, flutter_markdown

## Screenshots
Add images to the `images/` folder and update paths below.

![Home Screen](images/home.png)

![AI History](images/ai_history.png)

![Chat](images/chat.png)

## Installation
1. Install the Flutter SDK: https://flutter.dev/docs/get-started/install
2. Clone the repository and fetch dependencies:

```powershell
cd "d:\University\6th Semester\App Development\AI Study Assistant\aistudyassistant"
flutter pub get
```

3. Firebase setup:
- Create a Firebase project and enable Firestore + Authentication.
- Add `google-services.json` (Android) and `GoogleService-Info.plist` (iOS) to the corresponding platform folders.
- The Android build script already applies `com.google.gms.google-services` in `android/app/build.gradle.kts`.

4. Create a `.env` file at the project root with your Gemini API key:

```
GEMINI_API_KEY=your_gemini_api_key_here
```

5. Run the app:

```powershell
flutter run
```

## Usage
- Home: view subjects, start the AI generator, or open AI History.
- Generate: enter text/upload a file or link, choose number of cards, tap Generate. The app sends a composed `prompt` (instruction + your input) to Gemini.
- Review: open saved flashcard sets to flip, navigate, or delete cards.
- Chat: open subject-scoped chat to ask follow-ups. If the subject is primed, off-topic queries may cause Gemini to reply "The Question is not related to Subject" — the app will surface a dialog in that case.
- AI History: view paired prompt→answer sessions and reopen them; ChatPage will be seeded with the original prompt and answer.

## Project structure (detailed)
Important files and their responsibilities (top-level `lib/`):

- `main.dart`
  - App entry; provider wiring; route definitions.

- `state/subject_provider.dart`
  - Holds subjects, local `_history`, and `_chatHistory` maps.
  - `generateFlashcards(String subjectId, String source, {int count = 5})`:
    - Builds `instruction` string and final `prompt = '$instruction\n$source'`.
    - Calls `GeminiService.generateContent(prompt)`.
    - Sanitizes and parses raw response into Q/A pairs using `_cleanQA` and `_stripTrailingQuestion`.
    - Persists `History` object with `prompt` (sent) and `userPrompt` (entered) via `FirestoreService.saveHistory`.
    - Persists a paired prompt→answer via `persistChatEntry(...)` to create generator history documents.
  - Chat-related helpers: `addChatEntry(...)`, `persistChatEntry(...)`, `deleteChatEntry(...)`, `fetchChatForSubject(...)`, `fetchChatPairsForSubject(...)`.

- `services/gemini_service.dart`
  - `GeminiService.generateContent(String input)` — sends `input` to Gemini and returns the raw text reply.

- `services/firestore_service.dart`
  - Firestore helpers: `saveHistory`, `listHistories`, `deleteFlashcardSet`, `saveChatMessage`, `listChatMessages`, `addChatEntry` (paired), `listChatPairs`, `deleteChatEntry`.

- `pages/chat_page.dart`
  - `ChatPage` shows messages and provides `_addUserMessage(text)` which sends `text` directly to Gemini (chat flow) and persists messages.
  - Supports `initialMessages` and `loadHistory` flags to seed the screen or skip loading additional messages.

- `screens/flashcard_builder_screen.dart`
  - UI for user input and calling `generateFlashcards`.

- `screens/flashcard_review_screen.dart`
  - Review UI for a saved flashcard set; large navigation buttons.

- `screens/ai_history_screen.dart`
  - Lists paired prompt→answer sessions; allows opening (seed ChatPage) and deletion.

- `models/history.dart`
  - `History` model with `prompt` (full sent prompt), `userPrompt`, `rawReply`, `cards`, metadata.

- `widgets/` — UI components: `app_shell.dart`, `chat_input.dart`, `flashcard_tile.dart`, `subject_tile.dart`, `recent_flashcards.dart`, etc.

## Where prompts are sent & what is saved
- Chat: `ChatPage._addUserMessage(text)` sends `text` to Gemini: `generateContent(text)`.
- Generator: `SubjectProvider.generateFlashcards(...)` sends the composed `prompt` (`instruction + '\n' + source`) to Gemini; the code stores `History.prompt` (sent) and `History.userPrompt` (entered) separately.

## Dependencies
Open `pubspec.yaml` for exact versions. Key packages:
- provider
- flutter_dotenv
- firebase_core
- firebase_auth
- cloud_firestore
- image_picker
- file_picker
- flutter_markdown

## Future Improvements
- Better parsing and validation for Gemini outputs.
- Offline-first sync and caching for histories.
- Export/import flashcards (Anki/CSV) and bulk-edit tools.
- User profiles, settings, and multi-device sync.

## Author
Shaji Ul Islam Qamar

